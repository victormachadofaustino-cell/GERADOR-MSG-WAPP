<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#0d6efd" />
  <title>AgendaWapp</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- ====== TELA DE LOGIN ====== -->
  <div id="login-container" class="hidden">
    <h1>ğŸ” Login</h1>
    <form id="login-form">
      <div class="form-group">
        <label for="login-email">E-mail</label>
        <input type="email" id="login-email" autocomplete="username" required />
      </div>
      <div class="form-group">
        <label for="login-senha">Senha</label>
        <input type="password" id="login-senha" required autocomplete="current-password" />
      </div>
      <button type="submit" class="btn primario" style="width: 100%;">Entrar</button>
    </form>
  </div>

  <!-- ====== APP PRINCIPAL ====== -->
  <div id="app-container" class="hidden">
    
    <!-- HEADER -->
    <header class="app-header">
      <div class="app-header-title">
        <h1>Gerador de Eventos Musicais CCB</h1>
        <p id="user-email-display"></p>
      </div>

      <div style="display:flex;gap:8px;align-items:center; position: relative;">
        <!-- âœ… BotÃ£o Refresh Global -->
        <button id="btn-refresh-app" class="btn secundario" type="button" title="Atualizar dados">âŸ³</button>

        <!-- âœ… Perfil (VF) + menu -->
        <button id="btn-profile" class="profile-btn" type="button" aria-haspopup="true" aria-expanded="false" aria-controls="profile-menu">
          <span class="profile-avatar">VF</span>
        </button>

        <div id="profile-menu" class="profile-menu hidden" role="menu" aria-label="Menu do perfil">
          <button id="btn-logout" class="profile-menu-item" type="button" role="menuitem">Sair</button>
        </div>
      </div>
    </header>

    <!-- MAIN -->
    <main class="app-main">
      
      <!-- ====== PÃGINA: EVENTOS ====== -->
      <section id="pagina-eventos" class="app-page" data-page="eventos">
        <div class="page-header">
          <h2>ğŸ“… Eventos</h2>
          <button id="btn-novo-evento" class="btn primario">+ Evento</button>
        </div>

        <!-- Filtros -->
        <div class="event-filters" style="display:flex;gap:8px;flex-wrap:nowrap;overflow-x:auto;padding-bottom:4px;">
          <button class="event-filter-btn active" data-filter="todos">Todos</button>
          <button class="event-filter-btn" data-filter="reunioes">ReuniÃµes</button>
          <button class="event-filter-btn" data-filter="ensaios">Ensaios</button>
          <button class="event-filter-btn" data-filter="extras">Extras</button>
          <button class="event-filter-btn" data-filter="cancelados">Cancelados</button>
        </div>

        <!-- Lista de eventos (anos > meses > eventos) -->
        <ul id="lista-eventos" class="lista-anos"></ul>
      </section>

      <!-- ====== PÃGINA: GERADOR ====== -->
      <section id="pagina-gerador" class="app-page hidden" data-page="gerador">
        <div class="page-header">
          <h2>âœ¨ Gerador</h2>
        </div>

        <div class="card">
          <div class="form-group">
            <label for="mes-ano-ref">MÃªs / Ano</label>
            <input type="month" id="mes-ano-ref" class="input" required />
          </div>

          <div class="form-group">
            <label for="select-publico-gerador">PÃºblico-alvo</label>
            <select id="select-publico-gerador" class="input" required>
              <option value="">-- Selecione --</option>
            </select>
          </div>

          <button id="btn-gerar-mensagem" class="btn primario">
            Gerar Mensagem
          </button>
        </div>

        <div class="card" style="margin-top:16px;">
          <div class="form-group">
            <label for="mensagem-gerada">Mensagem Gerada</label>
            <textarea id="mensagem-gerada" class="input" rows="10" readonly></textarea>
          </div>

          <div style="display:flex; gap:8px;">
            <button id="btn-copiar-mensagem" class="btn secundario" type="button" style="flex:1;">
              ğŸ“‹ Copiar
            </button>

            <!-- âœ… NOVO: Limpar -->
            <button id="btn-limpar-mensagem" class="btn secundario" type="button" style="flex:1;">
              ğŸ§¹ Limpar
            </button>
          </div>
        </div>
      </section>

      <!-- ====== PÃGINA: TEMPLATES ====== -->
      <section id="pagina-templates" class="app-page hidden" data-page="templates">
        <div class="page-header">
          <h2>ğŸ“ Templates</h2>
          <button id="btn-novo-template" class="btn primario">+ Template</button>
        </div>
        <ul id="lista-templates" class="lista-acordeon"></ul>
      </section>

      <!-- ====== PÃGINA: CONFIGURAÃ‡Ã•ES ====== -->
      <section id="pagina-configuracoes" class="app-page hidden" data-page="configuracoes">
        <div class="page-header">
          <h2 id="settings-title">âš™ï¸ ConfiguraÃ§Ãµes</h2>
          <button id="btn-settings-add" class="btn primario" style="display:none;">+ Novo</button>
        </div>

        <!-- NavegaÃ§Ã£o de categorias -->
        <div class="settings-nav">
          <button class="settings-nav-btn" data-target="cidades">ğŸ™ï¸ Cidades</button>
          <button class="settings-nav-btn" data-target="comuns">ğŸ“ Comuns</button>
          <button class="settings-nav-btn" data-target="participantes">ğŸ‘¥ Participantes</button>
          <button class="settings-nav-btn" data-target="publicos_alvo">ğŸ¯ PÃºblicos</button>
          <button class="settings-nav-btn" data-target="realizacoes">ğŸ›ï¸ Locais</button>
          <button class="settings-nav-btn" data-target="titulos">ğŸ“‹ TÃ­tulos</button>
        </div>

        <!-- Lista de itens -->
        <ul id="settings-list" class="lista-acordeon"></ul>
      </section>

    </main>

    <!-- âœ… Assinatura acima do rodapÃ© -->
    <div class="app-signature">
      Secretaria de MÃºsica Regional JundiaÃ­ 2025
    </div>

    <!-- FOOTER NAV -->
    <nav class="app-footer-nav">
      <button class="footer-nav-item active" data-page="eventos">ğŸ“… Eventos</button>
      <button class="footer-nav-item" data-page="gerador">âœ¨ Gerador</button>
      <button class="footer-nav-item" data-page="templates">ğŸ“ Templates</button>
      <button class="footer-nav-item" data-page="configuracoes">âš™ï¸ Config</button>
    </nav>

  </div>

  <!-- ====== MODAIS (FORA DO APP-CONTAINER) ====== -->

  <!-- MODAL: ESCOLHER TIPO DE EVENTO -->
  <div id="modal-tipo-evento" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Escolha o tipo de evento</h3>
      </div>
      <div class="modal-body">
        <div class="tipo-buttons">
          <button class="tipo-btn reuniao-btn" data-tipo="reunioes">
            <span class="tipo-icone">ğŸ‘¥</span>
            <span>ReuniÃ£o Regional</span>
          </button>
          <button class="tipo-btn ensaio-btn" data-tipo="ensaios">
            <span class="tipo-icone">ğŸ­</span>
            <span>Ensaio Regional</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: FORM DE EVENTO -->
  <div id="evento-form-container" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="evento-modal-title">Novo Evento</h3>
      </div>
      <div class="modal-body">
        <form id="form-evento">
          
          <!-- Campos comuns -->
          <div class="form-group">
            <label for="evento-cidade">Cidade *</label>
            <select id="evento-cidade" required></select>
          </div>

          <div class="form-group">
            <label for="evento-comum">Local *</label>
            <select id="evento-comum" required></select>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="evento-data">Data *</label>
              <input type="date" id="evento-data" required />
            </div>
            <div class="form-group">
              <label for="evento-hora">Hora *</label>
              <input type="time" id="evento-hora" required />
            </div>
          </div>

          <div class="form-group">
            <label for="evento-desc-data">DescriÃ§Ã£o da Data</label>
            <input type="text" id="evento-desc-data" placeholder="Ex: 1Âº domingo / Ult. sÃ¡bado" />
          </div>

          <div class="form-group">
            <label for="evento-observacoes">ObservaÃ§Ãµes</label>
            <textarea id="evento-observacoes" rows="3"></textarea>
          </div>

          <!-- Campos especÃ­ficos de REUNIÃƒO -->
          <div id="campo-titulo-container" class="form-group hidden">
            <label for="evento-titulo">TÃ­tulo</label>
            <select id="evento-titulo"></select>
          </div>

          <div id="campo-realizacao-container" class="form-group hidden">
            <label for="evento-realizacao">RealizaÃ§Ã£o</label>
            <select id="evento-realizacao"></select>
          </div>

          <div id="campo-publico-qtd-container" class="form-group hidden">
            <label for="evento-publico-qtd">Quantidade de PÃºblico</label>
            <input type="number" id="evento-publico-qtd" min="0" />
          </div>

          <div id="campo-link-container" class="form-group hidden">
            <label for="evento-link">Link Externo</label>
            <input type="text" id="evento-link" placeholder="https://..." />
          </div>

          <div id="campo-publico-container" class="form-group hidden">
            <label>PÃºblicos-Alvo</label>
            <div id="evento-publicos-checkboxes" class="checkbox-group"></div>
          </div>

          <!-- Flags -->
          <div class="flags-group">
            <div class="flag-item">
              <label class="checkbox-label">
                <input type="checkbox" id="evento-cancelado" />
                <span>âŒ Evento Cancelado</span>
              </label>
            </div>
            <div id="flag-extra-container" class="flag-item hidden">
              <label class="checkbox-label">
                <input type="checkbox" id="evento-extra" />
                <span>â­ ReuniÃ£o ExtraordinÃ¡ria</span>
              </label>
            </div>
          </div>

        </form>
      </div>
      <div class="modal-footer">
        <button type="button" id="btn-cancelar-evento-form" class="btn secundario">Cancelar</button>
        <button type="submit" form="form-evento" class="btn primario">Salvar</button>
      </div>
    </div>
  </div>

  <!-- MODAL: FORM DE TEMPLATE -->
  <div id="template-form-container" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="template-modal-title">Novo Template</h3>
      </div>
      <div class="modal-body">
        <form id="form-template">
          <div class="form-group">
            <label for="template-nome">Nome *</label>
            <input type="text" id="template-nome" required />
          </div>
          <div class="form-group">
            <label for="template-tipo">Tipo *</label>
            <select id="template-tipo" required>
              <option value="">Selecione</option>
              <option value="convite">Convite</option>
              <option value="lembrete">Lembrete</option>
              <option value="cancelamento">Cancelamento</option>
            </select>
          </div>
          <div class="form-group">
            <label for="template-conteudo">ConteÃºdo *</label>
            <textarea id="template-conteudo" rows="8" required></textarea>
          </div>
          <div class="form-group">
            <label>VariÃ¡veis disponÃ­veis:</label>
            <div class="chips-variaveis">
              <button type="button" class="chip-var" data-var="{{cidade}}">{{cidade}}</button>
              <button type="button" class="chip-var" data-var="{{local}}">{{local}}</button>
              <button type="button" class="chip-var" data-var="{{data}}">{{data}}</button>
              <button type="button" class="chip-var" data-var="{{hora}}">{{hora}}</button>
              <button type="button" class="chip-var" data-var="{{titulo}}">{{titulo}}</button>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" id="btn-cancelar-template" class="btn secundario">Cancelar</button>
        <button type="submit" form="form-template" class="btn primario">Salvar</button>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="toast hidden"></div>

  <!-- FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- APP -->
  <script type="module" src="src/app.js"></script>

</body>
</html>