<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Agenda Musical CCB</title>
    <link rel="stylesheet" href="style.css">
    
    <meta name="theme-color" content="#1A73E8"> 
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png"> 
    <link rel="manifest" href="/manifest.json">
</head>
<body>
    
    <div id="toast-notification" role="status" aria-live="polite"></div>

    <div class="modal-backdrop" id="modal-backdrop"></div>
    
    <div class="modal" id="config-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-header"><h3 id="modal-title">Editar Item</h3></div>
        <div class="modal-body" id="modal-body">
            </div>
        <div class="modal-footer">
            <button class="secundario" id="modal-btn-cancelar">Cancelar</button>
            <button id="modal-btn-salvar">Salvar</button>
        </div>
    </div>

    <div class="modal" id="delete-modal" role="dialog" aria-modal="true">
        <div class="modal-header"><h3>Confirmar Exclus√£o</h3></div>
        <div class="modal-body" id="delete-modal-body">...</div>
        <div class="modal-footer">
            <button class="secundario" id="delete-modal-btn-cancelar">Cancelar</button>
            <button class="btn-danger" id="delete-modal-btn-confirmar">Sim, Excluir</button>
        </div>
    </div>
    
    <div class="modal" id="releases-modal" role="dialog" aria-modal="true">
        <div class="modal-header"><h3>Notas da Vers√£o</h3></div>
        <div class="modal-body" id="releases-modal-body">
            <h4>Build v11.0 (UX Refactor)</h4>
            <ul>
                <li><strong>M√≥dulo 3:</strong> Nova interface de navega√ß√£o lateral (Master-Detail).</li>
                <li><strong>M√≥dulo 4:</strong> Suporte completo a Layouts e Snippets inteligentes.</li>
                <li><strong>Performance:</strong> Carregamento de configura√ß√µes sob demanda.</li>
            </ul>
        </div>
        <div class="modal-footer">
            <button class="secundario" id="releases-modal-btn-fechar">Fechar</button>
        </div>
    </div>
    
    <div id="login-container">
        <div class="login-box">
            <h2>Gerador de Agenda Musical CCB</h2>
            <p style="text-align: center; color: #555;">Por favor, fa√ßa o login para continuar.</p>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-email">E-mail:</label>
                    <input type="email" id="login-email" required autocomplete="email">
                </div>
                <div class="form-group password-wrapper">
                    <label for="login-password">Senha:</label>
                    <input type="password" id="login-password" required autocomplete="current-password">
                    <button type="button" id="toggle-password" title="Mostrar/Ocultar Senha" aria-label="Mostrar senha">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </button>
                </div>
                <div class="login-links">
                    <a id="forgot-password" href="#">Esqueceu a senha?</a>
                </div>
                <div id="login-error-msg" role="alert"></div>
                <button type="submit">Entrar</button>
            </form>
        </div>
    </div>
    
    <div id="app-container">
        <header class="header">
            <h1>Gerador de Agenda Musical CCB</h1>
            
            <div class="profile-menu">
                <button class="profile-avatar" id="profile-avatar-btn" aria-haspopup="true" aria-expanded="false">VF</button>
                <div class="profile-dropdown" id="profile-dropdown" role="menu">
                    <div class="profile-email">Logado como:<br><span id="user-display">...</span></div>
                    <div class="profile-last-login">√öltimo login:<br><span id="last-login-display">Carregando...</span></div>
                    <a href="#" id="btn-releases" role="menuitem">Notas da Vers√£o</a>
                    <a href="#" id="btn-logout" role="menuitem">Sair</a>
                </div>
            </div>
        </header>

        <main id="paginaGerador" class="pagina ativa">
            <div class="coluna" id="col-output">
                <h2>Gerador de Mensagens</h2>
                
                <div class="botoes-template">
                    <label for="select_mes_gerador">M√™s da Agenda:</label>
                    <input type="month" id="select_mes_gerador" value="2025-11">
                    
                    <label for="select_publico_gerador">Filtrar para qual P√∫blico-Alvo?</label>
                    <select id="select_publico_gerador"></select>
                    
                    <label for="select_template_gerador">Usar qual Layout de Mensagem?</label>
                    <select id="select_template_gerador"></select>
                    
                    <button id="btnGerarMensagemMassa">Gerar Mensagem em Massa</button>
                </div>

                <textarea id="resultado" readonly placeholder="Sua mensagem formatada aparecer√° aqui..."></textarea>
                <button id="btnCopiar" class="secundario">Copiar Mensagem</button>
                <button id="btnLimparGerador" class="secundario">Limpar</button>
                <div id="msgCopiado" style="text-align: center; color: green;" role="status"></div>
            </div>
        </main>

        <main id="paginaGestao" class="pagina">
            <div class="coluna" id="col-form">
                <h2>Adicionar/Editar Evento</h2>
                <form id="formEvento">
                    <input type="hidden" id="eventoId">
                    
                    <fieldset class="form-section">
                        <legend>üìÖ Detalhes Essenciais</legend>
                        <div class="form-group" id="form-group-tipo">
                            <label for="select_tipo_evento">Tipo de Evento:</label>
                            <select id="select_tipo_evento" name="tipo_evento"></select>
                        </div>
                        
                        <div class="form-group-date-time-split">
                            <div class="form-group" id="form-group-data">
                                <label for="data">Data do Evento:</label>
                                <input type="date" id="data" required>
                            </div>
                            <div class="form-group" id="form-group-hora">
                                <label for="hora">Hora do Evento:</label>
                                <input type="time" id="hora" required>
                            </div>
                        </div>

                        <div class="form-group" id="form-group-desc_data">
                            <label for="desc_data">Descri√ß√£o da Data (para Agenda):</label>
                            <input type="text" id="desc_data" placeholder="Ex: Quarta Quarta-Feira / Segundo Domingo">
                        </div>
                        <div class="form-group" id="form-group-is_extra">
                            <input type="checkbox" id="is_extraordinaria" style="margin-top: 15px;">
                            <label for="is_extraordinaria" style="display: inline-block; font-weight: bold; color: #dc3545;">√â uma Reuni√£o Extraordin√°ria?</label>
                        </div>
                    </fieldset>

                    <fieldset class="form-section">
                        <legend>üè∑Ô∏è T√≠tulo e P√∫blico</legend>
                        <div class="form-group" id="form-group-sigla">
                            <label for="select_titulo">Sigla:</label>
                            <select id="select_titulo" name="select_titulo"></select>
                        </div>
                        <div class="form-group" id="form-group-titulo">
                            <label for="titulo">T√≠tulo do Evento (Autom√°tico):</label>
                            <input type="text" id="titulo" readonly style="background:#eee;">
                        </div>
                        <div class="form-group" id="form-group-publico">
                            <label for="select_participantes">Participantes (Quem vai?)</label>
                            <select id="select_participantes" name="select_participantes"></select>
                        </div>
                        <div class="form-group" id="form-group-quantidade">
                            <label for="observacoes">Quantidade (Autom√°tico):</label>
                            <input type="text" id="observacoes" readonly style="background:#eee;">
                        </div>
                        <div class="form-group" id="form-group-realizacao">
                            <label for="select_realizacao">Realiza√ß√£o (Local/Sala):</label>
                            <select id="select_realizacao" name="select_realizacao"></select>
                        </div>
                        <div class="form-group" id="form-group-cidade">
                            <label for="select_cidade">Cidade:</label>
                            <select id="select_cidade" name="select_cidade"></select>
                        </div>
                        <div class="form-group" id="form-group-comum">
                            <label for="select_comum">Comum Congrega√ß√£o:</label>
                            <select id="select_comum" name="select_comum" disabled></select>
                        </div>
                    </fieldset>
                    
                    <fieldset class="form-section">
                        <legend>üéØ P√∫blicos e Observa√ß√µes</legend>
                        <fieldset class="form-group" id="form-group-publicos_alvo" style="border: none; padding: 0 0 10px 0;">
                            <legend style="font-size: 0.9em; font-weight: 600; margin-bottom: 5px;">Etiquetar para quais P√∫blicos-Alvo?</legend>
                            <div id="checklist-publicos_alvo" class="checklist-container">Carregando...</div>
                        </fieldset>
                        
                        <div class="form-group" id="form-group-observacoes_extra">
                            <label for="observacoes_extra">Observa√ß√µes (Opcional):</label>
                            <textarea id="observacoes_extra" rows="3" placeholder="Ex: Antecipa√ß√£o de Reuni√£o..."></textarea>
                        </div>
                        <div class="form-group" id="form-group-link">
                            <div>
                                <input type="checkbox" id="checkLinkExterno" style="margin-top: 15px;">
                                <label for="checkLinkExterno" style="display: inline-block; font-weight: normal;">Adicionar Link Externo?</label>
                            </div>
                            <div id="linkExternoWrapper">
                                <label for="link_externo">Link Externo:</label>
                                <input type="text" id="link_externo" placeholder="Ex: https://calendar.app.google/...">
                            </div>
                        </div>
                    </fieldset>

                    <button type="submit" id="btnAdicionarEvento">Adicionar Novo Evento</button>
                    <button type="button" id="btnCancelarEdicao" class="secundario" style="width:100%; margin-top: 10px; display: none;">Cancelar Edi√ß√£o</button>
                </form>
            </div>

            <div class="coluna" id="col-lista">
                <h2>Lista de Eventos</h2>
                <div class="filter-buttons" id="filter-container">
                    <button class="ativa" data-filtro="todos">Todos</button>
                    <button data-filtro="reunioes">Reuni√µes</button>
                    <button data-filtro="ensaios">Ensaios</button>
                    <button data-filtro="extras">Extras</button>
                </div>
                <div id="statusLoading">Carregando eventos do Firebase...</div>
                <div id="listaEventos"></div>
            </div>
        </main>
        
        <main id="paginaConfiguracoes" class="pagina">
            <div class="settings-layout">
                <aside class="settings-sidebar">
                    <h3 class="sidebar-title">Configura√ß√µes</h3>
                    <button data-target="cidades" class="nav-btn">üèôÔ∏è Cidades</button>
                    <button data-target="comuns" class="nav-btn">‚õ™ Comuns</button>
                    <button data-target="participantes" class="nav-btn">üë• Participantes</button>
                    <button data-target="publicos_alvo" class="nav-btn">üéØ P√∫blicos-Alvo</button>
                    <button data-target="realizacoes" class="nav-btn">üìç Locais (Salas)</button>
                    <button data-target="titulos" class="nav-btn">üè∑Ô∏è T√≠tulos e Siglas</button>
                </aside>
                
                <section class="settings-content">
                    <div class="settings-header">
                        <h2 id="settings-title">Selecione uma categoria</h2>
                        <button id="btn-settings-add" class="btn-add">+ Novo Item</button>
                    </div>
                    <ul id="settings-list" class="config-list">
                        <li style="padding:20px; color:#777; text-align:center;">Clique em um item do menu ao lado para gerenciar.</li>
                    </ul>
                </section>
            </div>
        </main>
        
        <main id="paginaTemplates" class="pagina">
            <div class="config-panel coluna" id="template-list-panel">
                <h2>Gerador de Templates</h2>
                <p>Crie e edite os "Layouts" e "Componentes".</p>
                <button class="btn-add" id="btn-add-template">Adicionar Novo Template</button>
                <ul class="config-list" id="config-list-templates">
                    <li>Carregando...</li>
                </ul>
            </div>
        </main>
        
        <footer>
            <p>Secretaria da M√∫sica Regional Jundia√≠ &reg; 2025</p>
        </footer>
    </div> 
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script type="module" src="src/main.js"></script>
    
    <nav class="mobile-nav-footer">
        <button id="btnNavGerador" class="ativa">
            <span class="icon">‚öôÔ∏è</span>
            <span class="label">Gerador</span>
        </button>
        <button id="btnNavGestao">
            <span class="icon">üóìÔ∏è</span>
            <span class="label">Eventos</span>
        </button>
        <button id="btnNavConfig">
            <span class="icon">üõ†Ô∏è</span>
            <span class="label">Configura√ß√µes</span>
        </button>
        <button id="btnNavTemplates">
            <span class="icon">üìÑ</span>
            <span class="label">Templates</span>
        </button>
    </nav>
</body>
</html>